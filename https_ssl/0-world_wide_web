#!/usr/bin/env bash
# This script audits subdomains for a given domain and displays their DNS records.

function get_record() {
    local domain=$1
    local subdomain=$2

    # Query the DNS record using dig
    result=$(dig +short "$subdomain.$domain" | tail -n 1)

    if [ -z "$result" ]; then
        echo "The subdomain $subdomain.$domain does not exist."
    else
        echo "The subdomain $subdomain is an A record and points to $result"
    fi
}

# Check if at least 1 argument (domain) is provided
if [ $# -lt 1 ]; then
    echo "Usage: $0 domain [subdomain]"
    exit 1
fi

# Parameters
domain=$1
subdomain=$2

# If only domain is provided
if [ -z "$subdomain" ]; then
    for sub in www lb-01 web-01 web-02; do
        get_record "$domain" "$sub"
    done
else
    # If both domain and subdomain are provided
    get_record "$domain" "$subdomain"
fi

